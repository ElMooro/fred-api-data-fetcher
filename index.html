import requests
import json

# Your FRED API Key
# It's generally a good practice to store API keys securely,
# for example, as environment variables, rather than hardcoding them directly in scripts,
# especially if you plan to share or version control your code.
API_KEY = "2f057499936072679d8843d7fce99989" # User provided API key

# FRED API base URL for series observations
BASE_URL = "https://api.stlouisfed.org/fred/series/observations"

def get_fred_series_data(series_id, api_key, file_type="json", **kwargs):
    """
    Fetches data for a specific series from the FRED API.

    Args:
        series_id (str): The ID of the FRED series (e.g., "GNPCA").
        api_key (str): 2f057499936072679d8843d7fce99989.
        file_type (str, optional): The desired output format. Defaults to "json".
                                   Other options include "xml", "txt", "xls".
        **kwargs: Additional optional parameters for the API request, such as:
                  observation_start (str): Start date in YYYY-MM-DD format.
                  observation_end (str): End date in YYYY-MM-DD format.
                  units (str): "lin" (levels), "chg" (change), "ch1" (change from year ago),
                               "pch" (percent change), "pc1" (percent change from year ago),
                               "pca" (compounded annual rate of change),
                               "cch" (continuously compounded rate of change),
                               "cca" (continuously compounded annual rate of change),
                               "log" (natural log).
                  frequency (str): e.g., "d" (daily), "w" (weekly), "m" (monthly), "q" (quarterly), "a" (annual).
                  limit (int): Number of results to retrieve.
                  offset (int): Offset for pagination.
                  sort_order (str): "asc" or "desc".

    Returns:
        dict or str: Parsed JSON data as a dictionary if file_type is "json",
                     otherwise raw text content of the response.
                     Returns None if an error occurs.
    """
    params = {
        "series_id": series_id,
        "api_key": api_key,
        "file_type": file_type,
    }
    # Add any additional optional parameters to the request
    params.update(kwargs)

    try:
        response = requests.get(BASE_URL, params=params)
        response.raise_for_status()  # Raises an HTTPError for bad responses (4XX or 5XX)

        if file_type == "json":
            return response.json()  # Parses the JSON response into a Python dictionary
        else:
            return response.text # Returns raw text for other file types (xml, txt, etc.)

    except requests.exceptions.HTTPError as http_err:
        print(f"HTTP error occurred: {http_err}")
        print(f"Response content: {response.content.decode()}") # Show error message from FRED
    except requests.exceptions.ConnectionError as conn_err:
        print(f"Connection error occurred: {conn_err}")
    except requests.exceptions.Timeout as timeout_err:
        print(f"Timeout error occurred: {timeout_err