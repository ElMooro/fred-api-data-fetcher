<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Institutional-Grade Financial Analytics Suite</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-financial"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-zoom/1.2.1/chartjs-plugin-zoom.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }
        .container {
            padding: 20px;
        }
        .chart-container, .sentiment-container {
            margin: 20px auto;
            padding: 20px;
            border: 1px solid #ccc;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        canvas {
            max-width: 100%;
            height: auto;
        }
        .sentiment-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .sentiment-score {
            font-size: 24px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Institutional-Grade Financial Analytics Suite</h1>

        <!-- Candlestick Chart -->
        <div class="chart-container">
            <h2>Candlestick Chart</h2>
            <canvas id="candlestickChart"></canvas>
        </div>

        <!-- Sentiment Analysis -->
        <div class="sentiment-container">
            <h2>Sentiment Analysis</h2>
            <div class="sentiment-score" id="sentimentScore">Loading...</div>
        </div>

        <!-- RSI and Bollinger Bands -->
        <div class="chart-container">
            <h2>RSI and Bollinger Bands</h2>
            <canvas id="rsiBollingerChart"></canvas>
        </div>
    </div>

    <script>
        // Real-Time Candlestick Chart
        const candlestickCtx = document.getElementById('candlestickChart').getContext('2d');
        const candlestickChart = new Chart(candlestickCtx, {
            type: 'candlestick',
            data: {
                datasets: [{
                    label: 'AAPL',
                    data: [],
                    borderColor: '#2ecc71',
                    backgroundColor: '#3498db',
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    zoom: {
                        pan: {
                            enabled: true,
                            mode: 'xy'
                        },
                        zoom: {
                            enabled: true,
                            mode: 'xy'
                        }
                    }
                },
                scales: {
                    x: {
                        type: 'time',
                        time: {
                            unit: 'minute'
                        }
                    },
                    y: {
                        beginAtZero: false
                    }
                }
            }
        });

        // WebSocket for Real-Time Data
        const ws = new WebSocket('wss://eodhd.com/ws'); // Replace with actual EODHD WebSocket URL
        ws.onopen = () => {
            console.log('WebSocket connection established');
            ws.send(JSON.stringify({ action: 'subscribe', symbols: ['AAPL'] }));
        };
        ws.onmessage = (event) => {
            const message = JSON.parse(event.data);
            if (message.type === 'trade') {
                const data = message.data;
                const newCandle = {
                    t: data.timestamp, // Time
                    o: data.open,      // Open
                    h: data.high,      // High
                    l: data.low,       // Low
                    c: data.close      // Close
                };
                candlestickChart.data.datasets[0].data.push(newCandle);
                candlestickChart.update();
            }
        };

        // Sentiment Analysis
        const sentimentScoreElement = document.getElementById('sentimentScore');
        async function fetchSentiment() {
            const response = await fetch('https://api.arya.ai/sentiment?symbol=AAPL'); // Replace with actual Arya API URL
            const data = await response.json();
            sentimentScoreElement.innerText = `${data.sentimentScore > 0 ? 'Positive' : 'Negative'} (${data.sentimentScore})`;
        }
        fetchSentiment();

        // RSI and Bollinger Bands Chart
        const rsiBollingerCtx = document.getElementById('rsiBollingerChart').getContext('2d');
        const rsiBollingerChart = new Chart(rsiBollingerCtx, {
            type: 'line',
            data: {
                labels: ['2025-05-01', '2025-05-02', '2025-05-03', '2025-05-04'],
                datasets: [
                    {
                        label: 'RSI',
                        data: [30, 40, 50, 70],
                        borderColor: 'rgba(255, 99, 132, 1)',
                        borderWidth: 2,
                        fill: false
                    },
                    {
                        label: 'Bollinger Upper',
                        data: [160, 162, 164, 166],
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 2,
                        borderDash: [5, 5],
                        fill: false
                    },
                    {
                        label: 'Bollinger Lower',
                        data: [140, 138, 136, 134],
                        borderColor: 'rgba(153, 102, 255, 1)',
                        borderWidth: 2,
                        borderDash: [5, 5],
                        fill: false
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'top'
                    }
                },
                scales: {
                    x: {
                        type: 'category'
                    },
                    y: {
                        beginAtZero: false
                    }
                }
            }
        });
    </script>
</body>
</html>